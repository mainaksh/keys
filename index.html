<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bitcoin Key Space Explorer</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  margin: 0;
  background: #0a0e27;
  color: #c9d1d9;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
  line-height: 1.6;
}

.container {
  max-width: 1400px;
  margin: auto;
  padding: 20px;
}

header {
  background: linear-gradient(135deg, #1e2a3a 0%, #2d3748 100%);
  padding: 20px 24px;
  border-radius: 12px;
  margin-bottom: 16px;
  border: 1px solid #30363d;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

header h2 {
  margin: 0 0 8px 0;
  color: #58a6ff;
  font-size: 28px;
  font-weight: 600;
}

header p {
  margin: 0;
  color: #8b949e;
  font-size: 14px;
}

.page-indicator {
  background: #161b22;
  padding: 16px 24px;
  border-radius: 10px;
  margin-bottom: 16px;
  border: 1px solid #30363d;
  text-align: center;
  font-size: 18px;
  color: #58a6ff;
  font-weight: 500;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

.controls {
  background: #161b22;
  padding: 16px 20px;
  border-radius: 10px;
  margin-bottom: 16px;
  border: 1px solid #30363d;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

button {
  padding: 10px 16px;
  border-radius: 8px;
  border: none;
  background: linear-gradient(180deg, #1f6feb 0%, #1a5cd7 100%);
  color: #ffffff;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.2s ease;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

button:hover {
  background: linear-gradient(180deg, #2878ff 0%, #1f6feb 100%);
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(31,111,235,0.3);
}

button:active {
  transform: translateY(0);
}

input {
  padding: 10px 14px;
  border-radius: 8px;
  border: 1px solid #30363d;
  background: #0d1117;
  color: #c9d1d9;
  font-size: 14px;
  transition: all 0.2s ease;
}

input:focus {
  outline: none;
  border-color: #58a6ff;
  box-shadow: 0 0 0 3px rgba(88,166,255,0.1);
}

input::placeholder {
  color: #6e7681;
}

.info {
  background: #161b22;
  padding: 14px 20px;
  border-radius: 10px;
  margin-bottom: 16px;
  border: 1px solid #30363d;
  color: #8b949e;
  font-size: 14px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

table {
  width: 100%;
  border-collapse: collapse;
  font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
  background: #161b22;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  border: 1px solid #30363d;
}

thead {
  background: #1c2128;
  border-bottom: 2px solid #30363d;
}

th {
  padding: 14px 12px;
  text-align: left;
  color: #58a6ff;
  font-weight: 600;
  font-size: 13px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

td {
  padding: 12px;
  border-bottom: 1px solid #21262d;
  font-size: 13px;
  color: #c9d1d9;
}

tr:hover {
  background: #1c2128;
}

tr.highlight {
  background: rgba(56, 139, 253, 0.15);
  border-left: 3px solid #58a6ff;
}

tr.highlight:hover {
  background: rgba(56, 139, 253, 0.2);
}

/* Address links */
td:nth-child(4) a,
td:nth-child(5) a {
  color: #c9d1d9;
  text-decoration: none;
  transition: all 0.2s ease;
  display: inline-block;
  padding: 4px 8px;
  border-radius: 4px;
}

td:nth-child(4) a:hover,
td:nth-child(5) a:hover {
  color: #58a6ff;
  background: rgba(56, 139, 253, 0.1);
  text-decoration: underline;
}

/* Responsive */
@media (max-width: 768px) {
  .container { padding: 12px; }
  table { font-size: 11px; }
  th, td { padding: 8px 6px; }
  .controls { flex-direction: column; }
  button, input { width: 100%; }
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 12px;
  height: 12px;
}

::-webkit-scrollbar-track {
  background: #0d1117;
}

::-webkit-scrollbar-thumb {
  background: #30363d;
  border-radius: 6px;
}

::-webkit-scrollbar-thumb:hover {
  background: #484f58;
}
</style>
</head>

<body>
<div class="container">

<header>
<h2>üîë Bitcoin Key Space Explorer</h2>
<p>Pure JavaScript ¬∑ Offline ¬∑ Bitcoin-Core Correct ¬∑ No WASM</p>
</header>

<div class="page-indicator" id="pageIndicator">
Page: <span id="currentPage">1</span>
</div>

<div class="controls">
<button onclick="prev()">‚óÄ Previous</button>
<button onclick="next()">Next ‚ñ∂</button>
<button onclick="randomPage()">üé≤ Random Page</button>
<input id="pageInput" value="1" style="width:120px" placeholder="Page number">
<button onclick="gotoPage()">Go to Page</button>
<input id="wifInput" placeholder="Paste WIF key here" style="width:280px">
<button onclick="decodeWifAndJump()">üîç Decode & Jump</button>
</div>

<div class="info" id="info">Ready to explore the Bitcoin key space</div>

<table>
<thead>
<tr>
<th>Private Key</th>
<th>WIF (Compressed)</th>
<th>WIF (Uncompressed)</th>
<th>Address (Compressed)</th>
<th>Address (Uncompressed)</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

</div>

<!-- ===== LIBRARIES ===== -->
<script src="./secp256k1.umd.js"></script>
<script src="./Base58.min.js"></script>

<script>
"use strict";

/* ===== ALIAS ===== */
const bs58 = Base58;

/* ===== CONSTANTS ===== */
const N = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141n;
const KEYS_PER_PAGE = 128n;

/* ===== HELPERS ===== */
function bigIntTo32Bytes(n){
  const out = new Uint8Array(32);
  for(let i=31;i>=0;i--){ out[i]=Number(n & 255n); n >>= 8n; }
  return out;
}

/* ===== SHA-256 ===== */
async function sha256(d){
  return new Uint8Array(await crypto.subtle.digest("SHA-256", d));
}
async function hash256(d){
  return sha256(await sha256(d));
}

/* ===== RIPEMD-160 (CORRECT) ===== */
function ripemd160(msg) {
  const K1 = [0x00000000,0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xa953fd4e];
  const K2 = [0x50a28be6,0x5c4dd124,0x6d703ef3,0x7a6d76e9,0x00000000];
  const R1 = [
    0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,
    7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,
    3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,
    1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,
    4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13
  ];
  const R2 = [
    5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,
    6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,
    15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,
    8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,
    12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11
  ];
  const S1 = [
    11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,
    7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,
    11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,
    11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,
    9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6
  ];
  const S2 = [
    8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,
    9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,
    9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,
    15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,
    8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11
  ];

  function f(j,x,y,z){
    return j<16?x^y^z:
           j<32?(x&y)|(~x&z):
           j<48?(x|~y)^z:
           j<64?(x&z)|(y&~z):
                 x^(y|~z);
  }
  function rol(x,n){return (x<<n)|(x>>> (32-n));}

  const len = msg.length;
  const pad = new Uint8Array(((len + 8 >> 6) + 1) << 6);
  pad.set(msg);
  pad[len] = 0x80;
  const dv = new DataView(pad.buffer);
  dv.setUint32(pad.length - 8, len * 8, true);

  let h0=0x67452301,h1=0xefcdab89,h2=0x98badcfe,h3=0x10325476,h4=0xc3d2e1f0;

  for(let i=0;i<pad.length;i+=64){
    const X = new Uint32Array(pad.buffer,i,16);
    let al=h0,bl=h1,cl=h2,dl=h3,el=h4;
    let ar=h0,br=h1,cr=h2,dr=h3,er=h4;

    for(let j=0;j<80;j++){
      let t = rol(al + f(j,bl,cl,dl) + X[R1[j]] + K1[j/16|0], S1[j]) + el;
      al=el;el=dl;dl=rol(cl,10);cl=bl;bl=t>>>0;

      t = rol(ar + f(79-j,br,cr,dr) + X[R2[j]] + K2[j/16|0], S2[j]) + er;
      ar=er;er=dr;dr=rol(cr,10);cr=br;br=t>>>0;
    }

    const t = (h1 + cl + dr)>>>0;
    h1=(h2+dl+er)>>>0;
    h2=(h3+el+ar)>>>0;
    h3=(h4+al+br)>>>0;
    h4=(h0+bl+cr)>>>0;
    h0=t;
  }

  const out = new Uint8Array(20);
  new DataView(out.buffer).setUint32(0,h0,true);
  new DataView(out.buffer).setUint32(4,h1,true);
  new DataView(out.buffer).setUint32(8,h2,true);
  new DataView(out.buffer).setUint32(12,h3,true);
  new DataView(out.buffer).setUint32(16,h4,true);
  return out;
}

/* ===== BITCOIN ===== */
async function checksum(p){ return (await hash256(p)).slice(0,4); }

async function privateKeyToWIF(k, compressed){
  const kb = bigIntTo32Bytes(k);
  const p = compressed
    ? Uint8Array.from([0x80, ...kb, 0x01])
    : Uint8Array.from([0x80, ...kb]);
  return bs58.encode(Uint8Array.from([...p, ...await checksum(p)]));
}

async function privateKeyToAddress(k, compressed) {
  const point = secp256k1.pointFromScalar(
    bigIntTo32Bytes(k),
    false
  );

  const pubkey = secp256k1.pointCompress(
    point,
    compressed
  );

  const h160 = ripemd160(await sha256(pubkey));

  const payload = Uint8Array.from([0x00, ...h160]);
  return bs58.encode(
    Uint8Array.from([...payload, ...await checksum(payload)])
  );
}

function wifToPrivateKey(w){
  const d = bs58.decode(w);
  let k = 0n;
  for(const b of d.slice(1,33)) k = (k<<8n) + BigInt(b);
  if(k<=0n || k>=N) throw Error("Invalid WIF");
  return k;
}

/* ===== UI ===== */
let page = 1n;

async function render(p, target=null){
  page = p < 1n ? 1n : p;
  const start = (page-1n)*KEYS_PER_PAGE + 1n;
  const end = start + KEYS_PER_PAGE - 1n;
  
  // Update page indicator
  currentPage.textContent = page.toString();
  pageInput.value = page.toString();
  
  info.textContent = `Displaying keys ${start.toLocaleString()} ‚Äì ${end.toLocaleString()}`;
  tbody.innerHTML = "";
  
  for(let i=start;i<=end;i++){
    const tr=document.createElement("tr");
    if(target && i===target) tr.className="highlight";
    
    const wifComp = await privateKeyToWIF(i,true);
    const wifUncomp = await privateKeyToWIF(i,false);
    const addrComp = await privateKeyToAddress(i,true);
    const addrUncomp = await privateKeyToAddress(i,false);
    
    tr.innerHTML = `
<td>${i}</td>
<td>${wifComp}</td>
<td>${wifUncomp}</td>
<td><a href="https://blockchain.com/btc/address/${addrComp}" target="_blank" rel="noopener">${addrComp}</a></td>
<td><a href="https://blockchain.com/btc/address/${addrUncomp}" target="_blank" rel="noopener">${addrUncomp}</a></td>`;
    tbody.appendChild(tr);
  }
}

function next(){ render(page+1n); }
function prev(){ render(page-1n); }
function gotoPage(){ render(BigInt(pageInput.value||1)); }

function randomPage(){
  const max = N / KEYS_PER_PAGE;
  const r = new Uint32Array(2);
  crypto.getRandomValues(r);
  render(((BigInt(r[0])<<32n)|BigInt(r[1])) % max + 1n);
}

async function decodeWifAndJump(){
  try{
    const k = wifToPrivateKey(wifInput.value.trim());
    await render((k-1n)/KEYS_PER_PAGE+1n, k);
    info.textContent = `‚úì Successfully decoded WIF and jumped to key ${k}`;
  }catch(e){
    info.textContent = `‚úó Error: ${e.message}`;
  }
}

/* ===== INIT ===== */
render(1n);
</script>

</body>
</html>